"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[993],{993:(e,t,i)=>{i.r(t),i.d(t,{default:()=>y});var a=i(7876),s=i(4232),l=i(7041),r=i(457),c=i(4725),n=i(345),o=i(5104),d=i(3022),m=i(1354),p=i(727),u=i(3476),h=i(8070),v=i(2436),g=i(3410),f=i(612),x=i(5495);let w={id:"",title:"",shortDescription:"",longDescription:"",date:void 0,participants:""},y=()=>{let{toast:e}=(0,c.dj)(),[t,i]=(0,s.useState)([]),[y,j]=(0,s.useState)(w),[S,N]=(0,s.useState)(null),[D,A]=(0,s.useState)(!0),[k,C]=(0,s.useState)(void 0);(0,s.useEffect)(()=>{let e=localStorage.getItem("activitiesData");if(e)try{i(JSON.parse(e))}catch(e){console.error("Failed to parse saved activities data:",e)}(async()=>{i(await (0,u.r4)()),A(!1)})()},[]);let E=async()=>{if(!y.title||!y.shortDescription||!y.participants||!y.longDescription){e({title:"Error",description:"All the fields are required",variant:"destructive"});return}if(!k){e({title:"Error",description:"Date is required",variant:"destructive"});return}y.date=(0,h.GP)(k,"dd/MM/yyyy");let{error:t}=await (0,u.LT)(y);if(t){e({title:t.name,description:t.message,variant:"destructive"});return}e({title:"Success",description:"Activity was successfully uploaded"}),i(e=>[...e,y]),j(w)},b=async()=>{if(!S)return;let t=await (0,u.J0)(y);if(t){e({title:"Error",description:t.message,variant:"destructive"});return}e({title:"Success",description:"Activity was successfully updated"}),i(e=>e.map(e=>e.id===S?y:e)),N(null),j(w)},O=async e=>{var t,i,a;let s=await (0,x.Se)("".concat(e.id,".md"),"activities");if(!s)return;let l=await (0,f.S_)(s);l&&(e.longDescription=l,console.log(e.longDescription),j(e),C(new Date("".concat(null===(t=e.date)||void 0===t?void 0:t.split("/")[2],"-").concat(null===(i=e.date)||void 0===i?void 0:i.split("/")[1],"-").concat(null===(a=e.date)||void 0===a?void 0:a.split("/")[0]))),N(e.id))},T=async t=>{let a=await (0,u.$y)(t);if(204===a.status)e({title:"Success",description:"Activity was successfully deleted"});else{var s;e({title:String(a.status),description:null===(s=a.error)||void 0===s?void 0:s.message,variant:"destructive"})}i(e=>e.filter(e=>e.id!==t)),S===t&&(N(null),j(w))};return(0,a.jsx)(v.a,{isLoading:D,children:(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)(p.Zp,{className:"p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium mb-4",children:S?"Edit Activity":"Add New Activity"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(g.A,{id:"title",value:y.title,onChange:j,placeholder:"Introduction to ROS",htmlFor:"title",type:"TEXT",title:"Title"}),(0,a.jsx)(g.A,{id:"shortDescription",value:y.shortDescription,onChange:j,placeholder:"Hands-on workshop introducing fundamentals of Robot Operating System (ROS) development.",htmlFor:"shortDescription",type:"TEXT",title:"Short Description"}),(0,a.jsx)(g.A,{id:"longDescription",value:y.longDescription,onChange:j,placeholder:"Hands-on workshop introducing fundamentals of Robot Operating System (ROS) development.",htmlFor:"longDescription",type:"MARKDOWN",title:"Detailed Description"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsx)(g.A,{htmlFor:"date",title:"Date",id:"date",value:y.date,onChange:j,placeholder:"".concat(new Date().getDate(),"/").concat(new Date().getMonth(),"/").concat(new Date().getFullYear()),type:"DATE",date:k,setDate:C}),(0,a.jsx)(g.A,{id:"participants",value:y.participants,onChange:j,placeholder:"50",htmlFor:"participants",type:"TEXT",title:"Participants"})]}),S?(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(l.$,{onClick:b,className:"flex-1",children:[(0,a.jsx)(n.A,{className:"h-4 w-4 mr-2"})," Update Activity"]}),(0,a.jsx)(l.$,{variant:"destructive",onClick:()=>{N(null),j(w)},children:"Cancel"})]}):(0,a.jsxs)(l.$,{onClick:E,className:"w-full",children:[(0,a.jsx)(o.A,{className:"h-4 w-4 mr-2"})," Add Activity"]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium",children:"Current Activities"}),0===t.length?(0,a.jsx)("p",{className:"text-gray-500 italic",children:"No activities added yet."}):(0,a.jsx)(r.nD,{type:"single",collapsible:!0,className:"w-full",children:t.map(e=>(0,a.jsxs)(r.As,{value:e.id,children:[(0,a.jsx)(r.$m,{children:(0,a.jsx)("div",{className:"flex justify-between items-center w-full pr-4",children:(0,a.jsx)("span",{children:e.title})})}),(0,a.jsx)(r.ub,{children:(0,a.jsxs)("div",{className:"p-4 space-y-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:"Full Description:"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.shortDescription}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:"Date:"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.date})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:"Participants:"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.participants})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,a.jsxs)(l.$,{size:"sm",variant:"outline",onClick:()=>O(e),children:[(0,a.jsx)(d.A,{className:"h-4 w-4 mr-1"})," Edit"]}),(0,a.jsxs)(l.$,{size:"sm",variant:"destructive",onClick:()=>T(e.id),children:[(0,a.jsx)(m.A,{className:"h-4 w-4 mr-1"})," Delete"]})]})]})})]},e.id))}),(0,a.jsxs)(l.$,{onClick:()=>{localStorage.setItem("activitiesData",JSON.stringify(t)),e({title:"Changes saved",description:"Activities have been updated successfully."})},className:"w-full mt-4",children:[(0,a.jsx)(n.A,{className:"h-4 w-4 mr-2"})," Save All Changes"]})]})]})})}},3476:(e,t,i)=>{i.d(t,{$y:()=>n,J0:()=>r,LT:()=>c,r4:()=>l});var a=i(5263),s=i(5495);let l=async()=>{let{data:e,error:t}=await a.S.from("activities").select("*");if(t&&console.log(t),!e)throw Error("Could not fetch Activies");return JSON.parse(JSON.stringify(e))},r=async e=>{let{id:t,longDescription:i,...l}=e;await (0,s.VM)("".concat(t,".md"),"activities"),await (0,s.jW)("".concat(t,".md"),"activities",i);let{error:r}=await a.S.from("activities").update(l).eq("id",e.id);return r&&console.log(r),r},c=async e=>{let{id:t,longDescription:i,...l}=e,{data:r,error:c}=await a.S.from("activities").insert(l).select().single();return(await (0,s.jW)("".concat(r.id,".md"),"activities",i),c)?(console.log(c),{error:c}):{error:null}},n=async e=>{if(!await (0,s.xp)(e,"activities"))throw Error("Markdown file of ".concat(e," in activities folder could not be deleted"));return await a.S.from("activities").delete().eq("id",e)}},5495:(e,t,i)=>{i.d(t,{Se:()=>o,V6:()=>c,VM:()=>u,jW:()=>d,ts:()=>r,vS:()=>n,xp:()=>p});var a=i(612),s=i(5263);let l=async e=>{let{data:t,error:i}=await s.S.storage.from("media").list(e);return i?(console.log(i),[]):null==t?void 0:t.map(e=>e.name)},r=async e=>{let t=await l(e),i=[];for(let a=0;a<t.length;a++){let{data:l}=s.S.storage.from("media").getPublicUrl("".concat(e,"/").concat(t[a]));i.push(l.publicUrl)}return i},c=async(e,t,i)=>{let l=t.split(".")[t.split(".").length-1],r="image/".concat(l),c=i.replace(/^data:image\/\w+;base64,/,""),n=(0,a.i)(c,r),o="".concat(e,"/").concat(t),{data:d,error:m}=await s.S.storage.from("media").upload(o,n,{contentType:r,upsert:!0});return m&&console.log(m),d},n=async e=>{let{data:t,error:i}=await s.S.storage.from("media").remove(e);if(i){console.log(i);return}return t},o=async(e,t)=>{let{data:i,error:a}=await s.S.storage.from("media").download("markdown/".concat(t,"/").concat(e.split(".")[0],"/").concat(e));return a?(console.log(a),null):await i.text()},d=async(e,t,i)=>{let l="text/markdown",r=new File([(0,a.OO)(i)],e,{type:l});await s.S.storage.from("media").upload("markdown/".concat(t,"/").concat(e.split(".")[0],"/").concat(e),r,{contentType:l,upsert:!0})},m=async e=>{let t=[],{data:i,error:a}=await s.S.storage.from("media").list(e,{limit:1e3});if(a)return console.error("Error listing files:",a),[];for(let a of i){var l;if(a.name&&(null===(l=a.metadata)||void 0===l?void 0:l.mimetype)!=="inode/directory"&&t.push("".concat(e?e+"/":"").concat(a.name)),a.name&&null===a.metadata){let i="".concat(e?e+"/":"").concat(a.name),s=await m(i);t.push(...s)}}return t},p=async(e,t)=>{let i=await m("markdown/".concat(t,"/").concat(e));if(i.length>0){let{data:e,error:t}=await s.S.storage.from("media").remove(i);if(t){console.log(t);return}return e}throw Error('No files in the folder "markdown/'.concat(t,"/").concat(e,'"'))},u=async(e,t)=>{let{data:i,error:a}=await s.S.storage.from("media").remove(["markdown/".concat(t,"/").concat(e.split(".")[0],"/").concat(e)]);if(a){console.log(a);return}return i}}}]);